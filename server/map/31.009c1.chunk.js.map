{"version":3,"sources":["webpack:///./src/test-cases/modal/Test.js","webpack:///./src/test-cases/modal/Modal.less","webpack:///./src/test-cases/modal/Modal.js","webpack:///./src/test-cases/modal/Modal.less?98e7"],"names":["Test","state","visible","handleModalClick","openModal","_this","setState","handleModalClose","this","react__WEBPACK_IMPORTED_MODULE_0___default","a","createElement","onClick","role","_Modal__WEBPACK_IMPORTED_MODULE_1__","onClose","type","style","height","Component","module","exports","__webpack_require__","push","i","Modal","clickPosition","x","y","saveClickPosition","e","clientX","clientY","setTimeout","setTransformOrigin","modal","_this$modal$getBoundi","getBoundingClientRect","left","top","_this$clickPosition","undefined","leftOrigin","concat","topOrigin","transformOrigin","handleClose","props","document","documentElement","addEventListener","removeEventListener","prevProps","prevState","body","overflow","_this2","createPortal","react_transition_group__WEBPACK_IMPORTED_MODULE_3__","appear","in","timeout","classNames","unmountOnExit","className","ref","children","defaultProps","content","options","hmr","transform","insertInto","update","locals","hot","accept","newContent","b","key","idx","Error","dispose"],"mappings":"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","file":"app/chunks/31.009c1.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport Modal from './Modal';\n\nexport default class Test extends Component {\n  state = {\n    visible: true,\n  };\n\n  handleModalClick = () => {\n    // alert(\"click\");\n  };\n\n  openModal = () => {\n    this.setState({\n      visible: true,\n    });\n  };\n\n  handleModalClose = () => {\n    this.setState({\n      visible: false,\n    });\n  };\n\n  render() {\n    const { visible } = this.state;\n    return (\n      <div onClick={this.handleModalClick} role=\"none\">\n        App\n        <Modal visible={visible} onClose={this.handleModalClose}>\n          <div>content</div>\n        </Modal>\n        <button type=\"button\" onClick={this.openModal}>打开</button>\n        <div style={{ height: 1000 }} />\n      </div>\n    );\n  }\n}\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".modal-enter .modal-mask,.modal-appear .modal-mask{opacity:0}.modal-enter .modal,.modal-appear .modal{-webkit-transform:scale(0);transform:scale(0)}.modal-enter-active .modal-mask,.modal-appear-active .modal-mask{opacity:1}.modal-enter-active .modal,.modal-appear-active .modal{-webkit-transform:scale(1);transform:scale(1)}.modal-exit .modal-mask{opacity:1}.modal-exit .modal{-webkit-transform:scale(1);transform:scale(1)}.modal-exit-active .modal-mask{opacity:0}.modal-exit-active .modal{-webkit-transform:scale(0);transform:scale(0)}.modal-exit-done{display:none}.modal-hidden{display:none}.modal-wrapper{position:fixed;left:0;top:0;right:0;bottom:0}.modal-mask{position:absolute;left:0;top:0;right:0;bottom:0;background-color:rgba(0,0,0,0.65);z-index:2000;transition:all 300ms ease-out}.modal{position:relative;z-index:2000;width:200px;height:200px;background-color:white;margin:0 auto;top:100px;box-shadow:0 4px 12px rgba(0,0,0,0.15);border-radius:5px;transition:all 300ms ease-out}\", \"\"]);\n\n// exports\n","import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport classnames from 'classnames';\nimport { CSSTransition } from 'react-transition-group';\nimport './Modal.less';\n\nexport default class Modal extends Component {\n  clickPosition = {\n    x: null,\n    y: null,\n  }\n\n  static defaultProps = {\n    visible: false,\n  };\n\n  componentDidMount() {\n    document.documentElement.addEventListener('click', this.saveClickPosition);\n  }\n\n\n  componentWillUnmount() {\n    document.documentElement.removeEventListener('click', this.saveClickPosition);\n  }\n\n  getSnapshotBeforeUpdate(prevProps, prevState) {   \n    if (!prevProps.visible && this.props.visible) {\n      document.body.style.overflow = 'hidden';\n      this.setTransformOrigin();\n    } else {\n      document.body.style.overflow = '';\n    }\n    return null;\n  }\n\n  /**\n   * 保存点击位置，使modal从点击位置展开\n   */\n  saveClickPosition = (e) => {   \n    const { clientX, clientY } = e;\n    this.clickPosition = {\n      x: clientX,\n      y: clientY,\n    };\n\n    // 在一定时间后清除，防止不是打开modal的点击影响.\n    setTimeout(() => {\n      this.clickPosition = {\n        x: null,\n        y: null,\n      };\n    }, 100);\n  }\n\n  setTransformOrigin = () => {\n    if (!this.modal) {\n      return;\n    }\n    const { left, top } = this.modal.getBoundingClientRect();\n    const { x, y } = this.clickPosition;\n    if (x !== undefined && y !== undefined) {\n      const leftOrigin = `${left - x}px`;\n      const topOrigin = `${top - y}px`;\n      this.modal.style.transformOrigin = `${leftOrigin} ${topOrigin} 0px`;\n    } else {  \n      this.modal.style.transformOrigin = '';\n    }\n  }\n\n  handleClose = () => {\n    const { onClose } = this.props;\n    if (onClose) {\n      onClose();\n    }\n  };\n\n  render() {\n    const { visible } = this.props;\n    return createPortal(\n      <CSSTransition\n        appear // visible默认为true时，也触发动画\n        in={visible}\n        timeout={300}\n        classNames=\"modal\"\n        unmountOnExit={false}        \n      // onExited={this.handleClose}\n      >   \n        <div\n          className=\"modal-wrapper modal-exit-done\"\n        >\n          <div role=\"none\" className=\"modal-mask\" onClick={this.handleClose} />\n          <div\n            ref={(modal) => { this.modal = modal; }}\n            className=\"modal\"\n          >\n            <button type=\"button\" onClick={this.handleClose}>关闭</button>\n            {this.props.children}           \n          </div>\n        </div>        \n      </CSSTransition>,\n      document.body,\n    );\n  }\n}\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/src/index.js??ref--5-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-3!./Modal.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/src/index.js??ref--5-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-3!./Modal.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/src/index.js??ref--5-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-3!./Modal.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}"],"sourceRoot":""}